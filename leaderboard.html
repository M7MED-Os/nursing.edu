<!DOCTYPE html>
<html lang="ar" dir="rtl">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
    <title>Ù„ÙˆØ­Ø© Ø§Ù„Ù…ØªØµØ¯Ø±ÙŠÙ† | ØªÙ…Ø±ÙŠØ¶ Ø¨Ù†Ù‡Ø§</title>
    <link rel="stylesheet" href="assets/css/style.css">
    <link rel="manifest" href="manifest.json">
    <link rel="stylesheet" href="assets/css/bottom-nav.css">

    <!-- Favicons -->
    <link rel="icon" type="image/png" sizes="16x16" href="assets/images/favicon-16x16.png">
    <link rel="icon" type="image/png" sizes="32x32" href="assets/images/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="48x48" href="assets/images/favicon-48x48.png">
    <link rel="apple-touch-icon" sizes="180x180" href="assets/images/apple-touch-icon.png">

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">

    <style>
        .leaderboard-hero {
            background: linear-gradient(135deg, var(--primary-color) 0%, var(--primary-dark) 100%);
            color: white;
            padding: clamp(2rem, 8vw, 4rem) 0;
            text-align: center;
            margin-bottom: -3rem;
            position: relative;
            z-index: 1;
        }

        .leaderboard-hero h1 {
            font-size: clamp(1.8rem, 5vw, 3rem);
            margin-bottom: 0.5rem;
        }

        .leaderboard-hero p {
            font-size: clamp(0.9rem, 3vw, 1.1rem);
            opacity: 0.9;
        }

        .leaderboard-container {
            max-width: 800px;
            margin: 0 auto 4rem auto;
            position: relative;
            z-index: 2;
            padding: 0 1rem;
        }

        .full-leaderboard-card {
            background: white;
            border-radius: var(--radius-lg);
            box-shadow: var(--shadow-lg);
            overflow: hidden;
            border: 1px solid #E5E7EB;
        }

        .leaderboard-table {
            width: 100%;
            border-collapse: collapse;
        }

        .leaderboard-table th {
            background: #f8fafc;
            padding: 1.25rem 0.75rem;
            text-align: right;
            color: #64748b;
            font-size: clamp(0.75rem, 2vw, 0.9rem);
            font-weight: 700;
            border-bottom: 2px solid #f1f5f9;
        }

        .leaderboard-table td {
            padding: clamp(0.75rem, 3vw, 1.25rem) 0.5rem;
            border-bottom: 1px solid #f1f5f9;
            vertical-align: middle;
        }

        .rank-cell {
            width: 60px;
            text-align: center;
            font-weight: 900;
            font-size: clamp(1rem, 3vw, 1.2rem);
            color: #94a3b8;
        }

        .rank-1 {
            color: #d97706;
        }

        .rank-2 {
            color: #d97706;
            /* Goldish */
        }

        .rank-3 {
            color: #94a3b8;
            /* Silverish */
        }

        .medal-icon {
            font-size: clamp(1.2rem, 4vw, 1.5rem);
            margin-left: 5px;
        }

        .user-info-cell {
            display: flex;
            align-items: center;
            gap: clamp(8px, 2vw, 15px);
        }

        .user-avatar {
            width: 40px;
            height: 40px;
            background: #f1f5f9;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1rem;
            color: var(--primary-color);
            border: 2px solid white;
            box-shadow: var(--shadow-sm);
            flex-shrink: 0;
        }

        .user-name-box b {
            display: block;
            font-size: clamp(0.85rem, 2.5vw, 1.1rem);
            color: var(--text-dark);
            line-height: 1.2;
        }

        .user-name-box span {
            font-size: clamp(0.7rem, 2vw, 0.8rem);
            color: var(--text-light);
            display: block;
            margin-top: 2px;
        }

        .points-cell {
            text-align: center;
            font-weight: 900;
            font-size: clamp(1rem, 3vw, 1.3rem);
            color: var(--primary-color);
            min-width: 60px;
        }

        .points-label {
            display: block;
            font-size: 0.65rem;
            color: #94a3b8;
            font-weight: 400;
            margin-top: 2px;
        }

        .admin-badge {
            background: #fefce8;
            color: #a16207;
            padding: 1px 6px;
            border-radius: 4px;
            font-size: 0.6rem;
            border: 1px solid #fef08a;
            margin-right: 5px;
            display: inline-block;
        }

        @media (max-width: 480px) {
            .user-avatar {
                display: none;
                /* Hide avatar on tiny screens to fit name */
            }

            .rank-cell {
                width: 40px;
            }

            .leaderboard-table td {
                padding: 0.75rem 0.25rem;
            }
        }

        @media (max-width: 640px) {
            .leaderboard-hero {
                margin-bottom: 0;
                padding: 3rem 0;
            }

            .leaderboard-container {
                margin-top: 1rem;
            }
        }

        /* Filter Buttons Style */
        .filter-container {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            overflow-x: auto;
            padding-bottom: 5px;
            justify-content: center;
            flex-wrap: wrap;
        }

        .filter-btn {
            background: white;
            border: 1px solid #e2e8f0;
            color: #64748b;
            padding: 8px 16px;
            border-radius: 50px;
            font-size: 0.9rem;
            cursor: pointer;
            transition: all 0.2s;
            font-weight: 500;
            white-space: nowrap;
        }

        .filter-btn:hover {
            background: #f8fafc;
            border-color: #cbd5e1;
        }

        .filter-btn.active {
            background: var(--primary-color);
            color: white;
            border-color: var(--primary-color);
            box-shadow: 0 4px 6px -1px rgba(16, 185, 129, 0.2);
        }
    </style>
</head>

<body>

    <!-- Loading Screen (Disabled to prevent layout shift)
    <div id="loading" class="loading-overlay">
        <div class="spinner"></div>
        <p>Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„...</p>
    </div>
    -->

    <!-- Navbar -->
    <nav class="navbar">
        <div class="container">
            <a href="dashboard.html" class="logo">
                <img src="assets/images/logo-icon.webp" alt="Logo" class="brand-icon">
                <span class="logo-text">ØªÙ…Ø±ÙŠØ¶ <span class="logo-accent">Ø¨Ù†Ù‡Ø§</span></span>
            </a>

            <div class="menu-toggle">
                <i class="fas fa-bars"></i>
            </div>

            <div id="pwaLogoutBtn" class="pwa-logout-btn">
                <i class="fas fa-sign-out-alt"></i>
            </div>

            <ul class="nav-links">
                <li><a href="dashboard.html">Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</a></li>
                <li><a href="squad.html">Ø§Ù„Ø´Ù„Ø©</a></li>
                <li><a href="todo.html">Ø§Ù„Ù…Ù‡Ø§Ù…</a></li>
                <li><a href="leaderboard.html" class="active">Ø§Ù„Ù…ØªØµØ¯Ø±ÙŠÙ†</a></li>
                <li id="adminNavBtn" style="display: none;">
                    <a href="admin.html" style="color: var(--secondary-color); font-weight: bold;">
                        <i class="fas fa-shield-alt"></i> Admin
                    </a>
                </li>
                <li><a href="profile.html" id="navUserName">Ø§Ù„Ø¨Ø±ÙˆÙØ§ÙŠÙ„</a></li>
                <li><button id="logoutBtn" class="btn btn-outline" style="padding: 0.5rem 1rem;">Ø®Ø±ÙˆØ¬</button></li>
            </ul>
        </div>
    </nav>

    <!-- Header Section -->
    <header class="leaderboard-hero">
        <div class="container">
            <h1>ğŸ† Ù„ÙˆØ­Ø© Ø§Ù„Ø´Ø±Ù</h1>
            <p>Ø£ÙØ¶Ù„ Ø§Ù„Ø·Ù„Ø§Ø¨ Ø¹Ù„Ù‰ Ù…Ø³ØªÙˆÙ‰ Ø§Ù„Ù…Ù†ØµØ© ÙƒÙØ§Ø­Ø§Ù‹ ÙˆØªÙ‚Ø¯ÙŠØ±Ø§Ù‹</p>
        </div>
    </header>

    <!-- Leaderboard Table -->
    <div class="container leaderboard-container">
        <!-- View Switcher -->
        <div class="filter-container" style="margin-bottom: 30px;">
            <button class="filter-btn active" id="tabStudents" onclick="window.switchView('students')">
                <i class="fas fa-user-graduate"></i> Ø£ÙˆØ§Ø¦Ù„ Ø§Ù„Ø·Ù„Ø§Ø¨
            </button>
            <button class="filter-btn" id="tabSquads" onclick="window.switchView('squads')">
                <i class="fas fa-users"></i> Ø£ÙˆØ§Ø¦Ù„ Ø§Ù„Ø´Ù„Ù„
            </button>
        </div>

        <!-- Filters (Dynamic) -->
        <div id="filterContainer" class="filter-container" style="display: none; margin-top: -10px;"></div>

        <div class="full-leaderboard-card">
            <table class="leaderboard-table">
                <thead>
                    <tr>
                        <th style="text-align: center;">Ø§Ù„ØªØ±ØªÙŠØ¨</th>
                        <th>Ø§Ù„Ø·Ø§Ù„Ø¨</th>
                        <th style="text-align: center;">Ø§Ù„Ù†Ù‚Ø§Ø·</th>
                    </tr>
                </thead>
                <tbody id="leaderboardBody">
                    <!-- Loaded via JS -->
                    <tr>
                        <td colspan="3" style="text-align: center; padding: 4rem;">
                            <i class="fas fa-spinner fa-spin fa-2x" style="color: var(--primary-color);"></i>
                            <p style="margin-top: 1rem; color: var(--text-light);">Ø¬Ø§Ø±ÙŠ ØªØ±ØªÙŠØ¨ Ø§Ù„Ø£Ø¨Ø·Ø§Ù„...</p>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>


    <!-- Footer -->
    <footer class="footer">
        <div class="container">
            <div class="copyright" style="border: none; padding-top: 0;">
                <p>&copy; 2026 ØªÙ…Ø±ÙŠØ¶ Ø¨Ù†Ù‡Ø§</p>
            </div>
        </div>
    </footer>

    <!-- Bottom Navigation -->
    <nav class="bottom-nav">
        <div class="bottom-nav-container">
            <a href="dashboard.html" class="bottom-nav-item">
                <i class="fas fa-home"></i>
                <span>Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</span>
            </a>
            <a href="todo.html" class="bottom-nav-item">
                <i class="fas fa-tasks"></i>
                <span>Ø§Ù„Ù…Ù‡Ø§Ù…</span>
            </a>
            <a href="leaderboard.html" class="bottom-nav-item active">
                <i class="fas fa-trophy"></i>
                <span>Ø§Ù„Ø£ÙˆØ§Ø¦Ù„</span>
            </a>
            <a href="profile.html" class="bottom-nav-item">
                <i class="fas fa-user"></i>
                <span>Ø§Ù„Ø¨Ø±ÙˆÙØ§ÙŠÙ„</span>
            </a>
            <!-- <a href="#" id="bottomLogoutBtn" class="bottom-nav-item">
                <i class="fas fa-sign-out-alt"></i>
                <span>Ø®Ø±ÙˆØ¬</span>
            </a> -->
            <a href="admin.html" id="bottomAdminBtn" class="bottom-nav-item admin-link" style="display: none;">
                <i class="fas fa-shield-alt"></i>
                <span>Admin</span>
            </a>
        </div>
    </nav>



    <script src="assets/js/main.js"></script>
    <script type="module" src="assets/js/auth.js"></script>
    <script type="module" src="assets/js/squad-notifications.js"></script>

    <script type="module">
        import { supabase } from "./assets/js/supabaseClient.js";
        import { getCache, setCache } from "./assets/js/utils.js";

        // Mappings
        const gradeMap = {
            "1": "Ø§Ù„ÙØ±Ù‚Ø© Ø§Ù„Ø£ÙˆÙ„Ù‰",
            "2": "Ø§Ù„ÙØ±Ù‚Ø© Ø§Ù„Ø«Ø§Ù†ÙŠØ©",
            "3": "Ø§Ù„ÙØ±Ù‚Ø© Ø§Ù„Ø«Ø§Ù„Ø«Ø©",
            "4": "Ø§Ù„ÙØ±Ù‚Ø© Ø§Ù„Ø±Ø§Ø¨Ø¹Ø©"
        };
        const streamMap = {
            "pediatric": "Ù‚Ø³Ù… Ø§Ù„Ø£Ø·ÙØ§Ù„",
            "obs_gyn": "Ù‚Ø³Ù… Ø§Ù„Ù†Ø³Ø§",
            "nursing_admin": "Ù‚Ø³Ù… Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©",
            "psychiatric": "Ù‚Ø³Ù… Ø§Ù„Ù†ÙØ³ÙŠØ©"
        };

        // State
        let currentUserInfo = null;
        let currentView = 'students'; // 'students' or 'squads'
        let currentFilterStream = 'all'; // 'all' or specific stream key

        // Init
        window.addEventListener('DOMContentLoaded', async () => {
            const loadingGlobal = document.getElementById('loading');

            await fetchUserData();
            if (currentUserInfo) {
                setupFilters();
                await loadLeaderboardData();
            }

            if (loadingGlobal) {
                loadingGlobal.style.opacity = '0';
                setTimeout(() => { if (loadingGlobal.parentNode) loadingGlobal.remove(); }, 500);
            }
        });

        async function fetchUserData() {
            try {
                const { data: { user } } = await supabase.auth.getUser();
                if (!user) {
                    window.location.href = 'login.html';
                    return;
                }

                // Use global checkAuth if possible, but here we need specific fields
                let profile = getCache(`profile_${user.id}`);
                if (!profile) {
                    const { data } = await supabase
                        .from('profiles')
                        .select('id, full_name, points, grade, term, stream')
                        .eq('id', user.id)
                        .single();
                    profile = data;
                    if (profile) setCache(`profile_${user.id}`, profile, 10);
                }

                currentUserInfo = profile;

                // Default filter: User's stream (if year 3/4), else 'all'
                if ((profile.grade === '3' || profile.grade === '4') && profile.stream) {
                    currentFilterStream = profile.stream;
                } else {
                    currentFilterStream = 'all';
                }

            } catch (err) {
                console.error("Auth Error", err);
            }
        }

        function setupFilters() {
            const container = document.getElementById('filterContainer');
            if (!container || !currentUserInfo) return;

            const grade = currentUserInfo.grade;

            // Define Buttons based on Grade
            let buttons = [];

            if (grade === '3') {
                buttons = [
                    { label: 'Ø§Ù„Ø¯ÙØ¹Ø© ÙƒØ§Ù…Ù„Ø©', value: 'all' },
                    { label: 'Ù‚Ø³Ù… Ø§Ù„Ø£Ø·ÙØ§Ù„', value: 'pediatric' },
                    { label: 'Ù‚Ø³Ù… Ø§Ù„Ù†Ø³Ø§', value: 'obs_gyn' }
                ];
            } else if (grade === '4') {
                buttons = [
                    { label: 'Ø§Ù„Ø¯ÙØ¹Ø© ÙƒØ§Ù…Ù„Ø©', value: 'all' },
                    { label: 'Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„ØªÙ…Ø±ÙŠØ¶', value: 'nursing_admin' },
                    { label: 'Ù‚Ø³Ù… Ø§Ù„Ù†ÙØ³ÙŠØ©', value: 'psychiatric' }
                ];
            } else {
                container.style.display = 'none';
                return;
            }

            container.style.display = 'flex';
            container.innerHTML = buttons.map(btn => `
                <button class="filter-btn ${btn.value === currentFilterStream ? 'active' : ''}" 
                        onclick="window.changeFilter('${btn.value}')">
                    ${btn.label}
                </button>
            `).join('');
        }

        // Global functions for onclick
        window.changeFilter = (val) => {
            currentFilterStream = val;

            // Update UI
            document.querySelectorAll('.filter-btn').forEach(btn => {
                if (btn.getAttribute('onclick') && btn.getAttribute('onclick').includes(`window.changeFilter('${val}')`)) {
                    btn.classList.add('active');
                } else if (btn.getAttribute('onclick') && btn.getAttribute('onclick').includes('window.changeFilter')) {
                    btn.classList.remove('active');
                }
            });

            // Reload Data
            if (currentView === 'students') loadLeaderboardData();
            else loadSquadLeaderboardData();
        };

        window.switchView = (view) => {
            currentView = view;

            // Toggle Tab buttons
            document.getElementById('tabStudents').classList.toggle('active', view === 'students');
            document.getElementById('tabSquads').classList.toggle('active', view === 'squads');

            // Refresh Header Title
            const headerH1 = document.querySelector('.leaderboard-hero h1');
            headerH1.textContent = view === 'students' ? 'ğŸ† Ù„ÙˆØ­Ø© Ø§Ù„Ø´Ø±Ù' : 'ğŸ”¥ Ù‚Ù…Ø© Ø§Ù„Ø´Ù„Ù„';

            if (view === 'students') {
                document.querySelector('thead tr th:nth-child(2)').textContent = 'Ø§Ù„Ø·Ø§Ù„Ø¨';
                loadLeaderboardData();
            } else {
                document.querySelector('thead tr th:nth-child(2)').textContent = 'Ø§Ù„Ø´Ù„Ø©';
                loadSquadLeaderboardData();
            }
        };

        async function loadSquadLeaderboardData() {
            const body = document.getElementById('leaderboardBody');
            const user = currentUserInfo;

            body.innerHTML = '<tr><td colspan="3" style="text-align:center; padding:4rem;"><i class="fas fa-spinner fa-spin fa-2x"></i></td></tr>';

            const cacheKey = `squad_leaderboard_${user.grade}`;
            let squads = getCache(cacheKey);

            try {
                if (!squads) {
                    const { data, error } = await supabase.rpc('get_top_squads', {
                        p_limit: 10,
                        p_academic_year: gradeMap[user.grade] || user.grade
                    });
                    if (error) throw error;
                    squads = data;
                    setCache(cacheKey, squads, 15); // 15 min cache
                }

                if (!squads || squads.length === 0) {
                    body.innerHTML = '<tr><td colspan="3" style="text-align:center; padding: 2rem;">Ù…ÙÙŠØ´ Ø´Ù„Ù„ Ù„Ø³Ø© ÙÙŠ Ø¹ÙŠÙ„ØªÙƒ.. Ø§Ø¨Ø¯Ø£ Ø´Ù„ØªÙƒ Ø¯Ù„ÙˆÙ‚ØªÙŠ!</td></tr>';
                    return;
                }

                body.innerHTML = squads.map((s, i) => `
                    <tr>
                        <td class="rank-cell ${i < 3 ? 'rank-' + (i + 1) : ''}">
                            ${i === 0 ? '<i class="fas fa-crown medal-icon"></i>' : (i + 1)}
                        </td>
                        <td>
                            <div class="user-info-cell">
                                <div class="user-avatar" style="background: var(--secondary-color); color: white;">#</div>
                                <div class="user-name-box">
                                    <b>${s.name}</b>
                                    <span>${s.department || 'Ø¹Ø§Ù…'} - ${s.academic_year}</span>
                                </div>
                            </div>
                        </td>
                        <td class="points-cell">
                            ${s.points || 0}
                            <span class="points-label">Ù†Ù‚Ø·Ø©</span>
                        </td>
                    </tr>
                `).join('');

            } catch (err) {
                console.error(err);
                body.innerHTML = '<tr><td colspan="3" style="text-align:center; color:red;">Ø®Ø·Ø£ ÙÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„</td></tr>';
            }
        }

        async function loadLeaderboardData() {
            const body = document.getElementById('leaderboardBody');
            const user = currentUserInfo;

            body.innerHTML = `<tr><td colspan="3" style="text-align: center; padding: 4rem;"><i class="fas fa-spinner fa-spin fa-2x" style="color: var(--primary-color);"></i><p style="margin-top: 1rem; color: var(--text-light);">Ø¬Ø§Ø±ÙŠ ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù‚Ø§Ø¦Ù…Ø©...</p></td></tr>`;

            const oldMsg = document.getElementById('motivationMsg');
            if (oldMsg) oldMsg.remove();

            const cacheKey = `leaderboard_${user.grade}_${user.term}_${currentFilterStream}`;
            let data = getCache(cacheKey);

            try {
                if (!data) {
                    const { data: rpcData, error } = await supabase.rpc('get_top_students', {
                        p_limit: 50,
                        p_grade: user.grade,
                        p_term: user.term,
                        p_stream: currentFilterStream === 'all' ? null : currentFilterStream
                    });
                    if (error) throw error;
                    data = rpcData;
                    setCache(cacheKey, data, 15); // 15 min cache
                }

                // Update Title Context
                const headerP = document.querySelector('.leaderboard-hero p');
                let contextText = gradeMap[user.grade] || '';
                if (currentFilterStream === 'all') contextText += " (Ø§Ù„Ø¯ÙØ¹Ø© ÙƒØ§Ù…Ù„Ø©)";
                else if (streamMap[currentFilterStream]) contextText += ` - ${streamMap[currentFilterStream]}`;
                headerP.textContent = `Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…ØªØµØ¯Ø±ÙŠÙ† Ù„Ù€ ${contextText}`;

                if (!data || data.length === 0) {
                    body.innerHTML = '<tr><td colspan="3" style="text-align:center; padding: 2rem;">Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ù…ØªØµØ¯Ø±ÙŠÙ† ÙÙŠ Ù‡Ø°Ø§ Ø§Ù„ØªØµÙ†ÙŠÙ.</td></tr>';
                    return;
                }

                body.innerHTML = data.map((s, i) => {
                    const rank = i + 1;
                    let rankDisplay = rank;
                    let rankClass = rank <= 3 ? `rank-${rank}` : '';
                    if (rank === 1) rankDisplay = '<i class="fas fa-crown medal-icon"></i>';
                    else if (rank === 2) rankDisplay = '<i class="fas fa-medal medal-icon" style="color:#d97706"></i>';
                    else if (rank === 3) rankDisplay = '<i class="fas fa-medal medal-icon" style="color:#94a3b8"></i>';

                    const rowClass = s.id === user.id ? 'style="background-color: #f0f9ff;"' : '';
                    const displayStream = streamMap[s.stream] || '';
                    const subText = displayStream ? `<span style="font-size:0.8em; color:var(--primary-color);">(${displayStream})</span>` : (gradeMap[s.grade] || '-');

                    return `<tr ${rowClass}><td class="rank-cell ${rankClass}">${rankDisplay}</td><td><div class="user-info-cell"><div class="user-avatar">${s.full_name ? s.full_name[0] : '?'}</div><div class="user-name-box"><b>${s.full_name} ${s.id === user.id ? '(Ø£Ù†Øª)' : ''}</b><span>${subText}</span></div></div></td><td class="points-cell">${s.points || 0}<span class="points-label">Ù†Ù‚Ø·Ø©</span></td></tr>`;
                }).join('');

                const belongsToFilter = (currentFilterStream === 'all') || (currentFilterStream === user.stream);
                const isUserInTop10 = data.slice(0, 10).some(s => s.id === user.id);

                if (belongsToFilter && !isUserInTop10 && data.length > 0) {
                    const lastInListPoints = data[data.length - 1].points || 0;
                    const diff = lastInListPoints - (user.points || 0);
                    if (diff > 0) {
                        const motivationMsg = document.createElement('div');
                        motivationMsg.id = 'motivationMsg';
                        motivationMsg.style.cssText = `background: white; padding: 1rem; margin-top: 1rem; border-radius: 12px; text-align: center; box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1); border: 1px dashed var(--primary-color); color: #475569;`;
                        motivationMsg.innerHTML = `<i class="fas fa-rocket" style="color: var(--primary-color); font-size: 1.2rem;"></i><span style="font-weight: bold; margin: 0 5px;">Ø£Ù†Øª Ø¨Ø·Ù„!</span>Ø¨Ø§Ù‚ÙŠ Ù„Ùƒ <span style="color: var(--primary-color); font-weight: 900; font-size: 1.1rem;">${diff + 1}</span> Ù†Ù‚Ø·Ø© ÙˆØªØ¯Ø®Ù„ Ù‡Ø°Ù‡ Ø§Ù„Ù‚Ø§Ø¦Ù…Ø©!`;
                        document.querySelector('.full-leaderboard-card').after(motivationMsg);
                    }
                }
            } catch (err) {
                console.error(err);
                body.innerHTML = '<tr><td colspan="3" style="text-align:center; color:red; padding: 2rem;">Ø®Ø·Ø£ ÙÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„</td></tr>';
            }
        }
    </script>

</body>

</html>